### **Why Do We Need All Three Dependencies?**

|   |   |
|---|---|
|**Dependency**|**Purpose**|
|`jjwt-api`|Contains the core JWT API for token creation and parsing.|
|`jjwt-impl`|Provides the **implementation** of the JWT API (required for actual token operations).|
|`jjwt-jackson`|Uses **Jackson** to serialize/deserialize JWT claims (especially when using JSON Web Tokens).|

- Answer
    
    ### **üìå Question for Interview Candidates**
    
    _‚ÄúIn Spring Boot, if you need to use JWT-based authentication, what `jjwt` dependencies do you need to add? Why do we need `jjwt-api`, `jjwt-impl`, and `jjwt-jackson` separately?‚Äù_
    
    ‚úî **Expected Answer:**
    
    - `jjwt-api` is the core API.
    - `jjwt-impl` is required because `jjwt-api` **only defines interfaces** and does not contain implementations.
    - `jjwt-jackson` allows **parsing JWT claims in JSON format**.

  

  

- In a Spring Boot application, how can you implement a `JwtService` for generating and validating JWT tokens? Explain the key components involved and how they work
    
    ### **‚úî Key Components of a** `**JwtService**`
    
    ‚úî **1. Injecting the Secret Key**
    
    - The secret key is **fetched from application properties (**`**jwt.secretKey**`**)**.
    - It is converted to a `SecretKey` using `Keys.hmacShaKeyFor()`.
    
    ‚úî **2. Generating a JWT Token (**`**generateToken()**`**)**
    
    - `Jwts.builder()` is used to **create a JWT**.
    - `setSubject(userId)` ‚Üí Stores the **user ID** inside the token.
    - `.claim("email", user.getEmail())` ‚Üí Adds **custom claims** (e.g., user email).
    - `.claim("roles", Set.of("ADMIN","USER"))` ‚Üí Adds **user roles**.
    - `.issuedAt(new Date())` ‚Üí Sets **token issue time**.
    - `.expiration(new Date(System.currentTimeMillis() + 1000*60))` ‚Üí **Expires in 1 minute**.
    - `.signWith(getSecretKey())` ‚Üí **Digitally signs the JWT** using **HMAC SHA key**.
    
    ‚úî **3. Extracting User ID from Token (**`**getUserIdFromToken()**`**)**
    
    - Uses `Jwts.parser()` to **validate the token and extract claims**.
    - `.parseSignedClaims(token).getPayload()` ‚Üí Retrieves **JWT claims**.
    - `claims.getSubject()` ‚Üí Extracts the **user ID from the subject**.
    
    ‚úî **4. Secret Key Handling (**`**getSecretKey()**`**)**
    
    - **Encodes the secret key using UTF-8** to create an HMAC SHA key.
    
    ---
    
    ### **üõ† Correct Implementation of** `**JwtService**` **(Reference Code)**
    
    ```Java
    java
    CopyEdit
    package com.rohit.securityApp.SecurityApplication.services;
    
    import com.rohit.securityApp.SecurityApplication.entities.User;
    import io.jsonwebtoken.Claims;
    import io.jsonwebtoken.Jwts;
    import io.jsonwebtoken.security.Keys;
    import org.springframework.beans.factory.annotation.Value;
    import org.springframework.stereotype.Service;
    
    import javax.crypto.SecretKey;
    import java.nio.charset.StandardCharsets;
    import java.util.Date;
    import java.util.Set;
    
    @Service
    public class JwtService {
    
        @Value("${jwt.secretKey}")
        private String jwtSecretKey;
    
        // Generate JWT token
        public String generateToken(User user){
            return Jwts.builder()
                    .subject(user.getId().toString())  // Set user ID as subject
                    .claim("email", user.getEmail())  // Custom claims
                    .claim("roles", Set.of("ADMIN","USER"))
                    .issuedAt(new Date())
                    .expiration(new Date(System.currentTimeMillis() + 1000*60)) // 1 min expiration
                    .signWith(getSecretKey())  // Signing JWT
                    .compact();
        }
    
        // Extract User ID from JWT
        public Long getUserIdFromToken(String token){
            Claims claims = Jwts.parser()
                    .verifyWith(getSecretKey())  // Validate JWT
                    .build()
                    .parseSignedClaims(token)
                    .getPayload();
    
            return Long.valueOf(claims.getSubject());  // Extract user ID
        }
    
        // Generate Secret Key
        private SecretKey getSecretKey() {
            return Keys.hmacShaKeyFor(jwtSecretKey.getBytes(StandardCharsets.UTF_8));
        }
    }
    
    ```
    
      
    
    ---