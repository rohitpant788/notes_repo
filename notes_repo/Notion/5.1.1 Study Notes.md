---

## **🔐 Importance of Security in Applications**

Security is a **fundamental aspect** of any application. Without proper security measures:

✅ User data can be **compromised**.

✅ Unauthorized users may **access restricted areas**.

✅ Applications are exposed to **financial and legal risks**.

Every modern application implements **authentication and authorization** to protect user data:

- Users must **authenticate** themselves before accessing resources.
- Different roles have **restricted access** (e.g., **admin-only routes** vs. **user routes**).

**Example:**

- An **Admin** can access **admin routes**.
- A **normal user** can access **only general routes**.
- Unauthorized users **should be blocked** from accessing restricted data.

📢 **Spring Security** is a mini-framework within Spring Boot that helps in implementing security in applications.

---

## **📚 Course Overview: Learning Spring Security**

This course is divided into **two modules**:

### **1️⃣ Module 1 - Authentication**

- Understanding **how authentication works**.
- Different authentication methods:
    - **Email & Password**
    - **CSRF Token**
    - **JWT & Refresh Tokens**
    - **OAuth Authentication** (Google, GitHub, Facebook, etc.)

### **2️⃣ Module 2 - Authorization**

- Assigning **roles** to users (e.g., Admin vs. Normal User).
- Restricting access to **routes based on roles**.
- Ensuring **only authorized personnel** can access certain functionalities.

---

# **⚠️ Security Attacks & Their Prevention**

In today's session, we will focus on **common security vulnerabilities** that attackers can exploit and how Spring Security helps mitigate them.

## **1️⃣ Cross-Site Request Forgery (CSRF) Attack**

### **🛑 What is CSRF Attack?**

A **malicious user** tricks an **authenticated user** into performing unwanted actions on a trusted website **without their consent**.

### **⚡ How does it work?**

1. **User logs into a banking system.**
    - A **session ID** is stored in cookies.
2. **Attacker sends a malicious link** via email or a fake website.
3. **User unknowingly clicks the link**, performing unintended actions (e.g., transferring money).
4. **Browser automatically sends the stored session ID**, making the bank think the request is legitimate.
5. The banking system **processes the request**, thinking it’s from the user.

---

### **🎯 Example: CSRF Attack on a Banking System**

📌 **Scenario:**

1️⃣ User logs into their **banking website** (e.g., `statebankofindia.com`).

2️⃣ The bank assigns a **session ID**, stored in cookies.

3️⃣ Attacker **sends a phishing email** with a fake link:

- **Example:** `Click here to claim your reward!`
- This redirects to a **fake banking website** (`statebankofindla.com`, where "i" is replaced by "l").4️⃣ User unknowingly **clicks the link** and logs in.5️⃣ The fake website sends a **hidden request to transfer ₹5000** to the attacker's account.6️⃣ The **browser sends the session ID automatically**, thinking it’s a valid request.7️⃣ The bank system **approves the transaction** without the user's knowledge.

---

### **🔒 How to Prevent CSRF Attacks?**

Spring Security **mitigates CSRF attacks using CSRF Tokens**.

✅ **CSRF Token-Based Protection**

- A unique **CSRF token** is issued during login.
- This **token is required** for making **state-changing requests** (POST, PUT, DELETE).
- Attackers **cannot access the token**, making the attack ineffective.

✅ **Steps in CSRF Prevention**

1️⃣ **User logs in** → Server generates a **CSRF token** and sends it along with the session.

2️⃣ The **CSRF token is stored in a hidden field** inside the login form.

3️⃣ When making requests, the **CSRF token is sent along with the request**.

4️⃣ The server **validates the token** before processing the request.

5️⃣ If the **CSRF token is missing or invalid**, the request is **rejected**.

📢 **Spring Security enables CSRF protection by default**, making it easier to defend against these attacks.

---

## **2️⃣ Cross-Site Scripting (XSS) Attack**

### **🛑 What is an XSS Attack?**

An attacker **injects malicious scripts** into a web page, which then executes in the browser of unsuspecting users.

### **⚡ How does it work?**

1. **Attacker injects a malicious script** inside an input field (e.g., comments, search bar).
2. The **website does not sanitize the input** and stores it.
3. When another user views the page, the **script executes automatically**.
4. The attacker **steals cookies, session data, or redirects users** to malicious websites.

### **🎯 Example: XSS Attack via Comments**

1️⃣ Attacker posts a comment:

```HTML

<script>alert('Your session has expired!');</script>

```

2️⃣ Any user visiting the page will **see the alert pop-up**.

3️⃣ Instead of an alert, the attacker can inject **stealth scripts** to steal session tokens and send them to a hacker’s server.

---

### **🔒 How to Prevent XSS Attacks?**

✅ **Input Validation:**

- Reject inputs containing **HTML tags (**`**<script>**`**)**.
- Use **Spring Boot’s built-in validators** like:
    
    ```Java
    
    @Pattern(regexp="^[a-zA-Z0-9 ]+$")
    
    ```
    

✅ **Output Encoding:**

- Convert special characters into safe HTML entities (`<` → `&lt;`, `>` → `&gt;`).
- **Example in Java:**
    
    ```Java
    
    HtmlUtils.htmlEscape(userInput);
    
    ```
    

✅ **Use Content Security Policy (CSP):**

- Restrict where scripts can be executed.

📢 **Spring Security provides built-in protections against XSS.**

---

## **3️⃣ SQL Injection Attack**

### **🛑 What is SQL Injection?**

An attacker injects **malicious SQL queries** into an input field, making the application **execute unintended database queries**.

### **⚡ How does it work?**

1. **Application has a vulnerable query**:
    
    ```SQL
    
    SELECT * FROM users WHERE username = 'input';
    
    ```
    
2. Attacker enters:
    
    ```SQL
    
    '' OR '1'='1
    
    ```
    
3. The query becomes:
    
    ```SQL
    
    SELECT * FROM users WHERE username = '' OR '1'='1';
    
    ```
    
4. Since **1=1 is always TRUE**, all users’ data is exposed.

---

### **🔒 How to Prevent SQL Injection?**

✅ **Use Prepared Statements:**

```Java

PreparedStatement stmt = conn.prepareStatement("SELECT * FROM users WHERE username = ?");
stmt.setString(1, userInput);

```

✅ **Use ORM (Hibernate) to avoid raw SQL queries.**

✅ **Sanitize user input and validate all inputs.**

📢 **Spring Security works with ORM frameworks like Hibernate to protect against SQL Injection.**

---

# **📌 Summary for Quick Revision**

|   |   |   |
|---|---|---|
|**Attack Type**|**Description**|**Prevention**|
|**CSRF**|Trick user into making unwanted requests|Use **CSRF Tokens**|
|**XSS**|Inject **malicious scripts** into web pages|**Input Validation, Output Encoding, CSP**|
|**SQL Injection**|Inject SQL code to manipulate queries|**Prepared Statements, ORM, Input Validation**|

### **🔹 Key Takeaways:**

✅ **CSRF** attacks exploit **browser trust**—use **tokens** to prevent them.

✅ **XSS** attacks **inject malicious scripts**—sanitize **input & output**.

✅ **SQL Injection** manipulates queries—use **prepared statements & ORM**.

### **Next Steps 🚀**

- In the **next session**, we will look at **Spring Security implementation** with code examples.
- We will see **how CSRF tokens are implemented in Spring Boot**.