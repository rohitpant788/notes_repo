### **Spring Boot: Sorting and Pagination with Spring Data JPA**

---

## **üìå Introduction**

In this session, we will explore how to **sort** and **paginate** data in a **Spring Boot** application using **Spring Data JPA**. These concepts are crucial when working with large datasets, as they help in **optimizing performance** and **enhancing the user experience**. We will cover:

- **Sorting** with `OrderBy`, `Sort`, and **dynamic sorting**.
- **Pagination** with `Pageable` and `PageRequest`.
- **Combining Sorting & Pagination** for optimal data retrieval.

---

## **üîç Filtering and Sorting Data**

Before we begin sorting, let‚Äôs understand the basics of **filtering** in Spring Data JPA.

### **‚û°Ô∏è Filtering by Fields**

Spring Data JPA allows us to **filter records** based on different fields using method naming conventions.

```Java
java
CopyEdit
List<ProductEntity> findByTitle(String title);

```

üí° **Example:** Fetches products **by title**.

### **‚û°Ô∏è Sorting with Method Naming**

We can **sort** by adding `OrderBy` in the method name.

```Java
java
CopyEdit
List<ProductEntity> findByTitleOrderByPrice(String title);

```

üí° **Example:** Returns products **filtered by title** and **sorted by price**.

---

## **üìå Implementing Sorting**

Sorting allows us to order data based on a **specific field**, such as **price, title, quantity, etc.**.

### **‚û°Ô∏è Defining** `**ProductRepository**` **with Sorting**

```Java
java
CopyEdit
@Repository
public interface ProductRepository extends JpaRepository<ProductEntity, Long> {

    // Sorting by Title
    List<ProductEntity> findByTitleOrderByPrice(String title);

    // Dynamic Sorting using Sort Parameter
    List<ProductEntity> findAll(Sort sort);

    // Pagination with Sorting
    Page<ProductEntity> findAll(Pageable pageable);
}

```

### **‚û°Ô∏è Sorting with a REST API**

We expose an API to **sort products dynamically**.

```Java
java
CopyEdit
@RestController
@RequestMapping("/products")
public class ProductController {

    private final ProductRepository productRepository;

    public ProductController(ProductRepository productRepository) {
        this.productRepository = productRepository;
    }

    @GetMapping("/sorted")
    public List<ProductEntity> getAllProductsSorted(@RequestParam(defaultValue = "id") String sortBy) {
        return productRepository.findAll(Sort.by(sortBy));
    }
}

```

üí° **API Call:** `http://localhost:8080/products/sorted?sortBy=price`

---

## **üìå Advanced Sorting Techniques**

### **‚û°Ô∏è Sorting by Multiple Fields**

```Java
java
CopyEdit
Sort sort = Sort.by(Sort.Order.desc("quantity"), Sort.Order.asc("price"));
List<ProductEntity> sortedProducts = productRepository.findAll(sort);

```

üí° **Primary Sort: Descending** order by `quantity`

üí° **Secondary Sort: Ascending** order by `price`

### **‚û°Ô∏è Dynamic Sorting in API**

```Java
java
CopyEdit
@GetMapping("/sorted-multiple")
public List<ProductEntity> getAllProductsSortedByMultipleFields() {
    Sort sort = Sort.by(
        Sort.Order.desc("quantity"),
        Sort.Order.asc("price")
    );
    return productRepository.findAll(sort);
}

```

üí° **API Call:** `http://localhost:8080/products/sorted-multiple`

---

## **üìå Implementing Pagination**

Pagination helps in **retrieving a subset of records**, reducing **load** on the database.

### **‚û°Ô∏è Using** `**Pageable**`

```Java
java
CopyEdit
Pageable pageable = PageRequest.of(0, 5); // Page 0, 5 records per page
Page<ProductEntity> page = productRepository.findAll(pageable);

```

### **‚û°Ô∏è** `**ProductRepository**` **for Pagination**

```Java
java
CopyEdit
@Repository
public interface ProductRepository extends JpaRepository<ProductEntity, Long> {

    // Pagination: Find All with Pageable
    Page<ProductEntity> findAll(Pageable pageable);
}

```

### **‚û°Ô∏è API for Pagination**

```Java
java
CopyEdit
@GetMapping("/paginated")
public Page<ProductEntity> getPaginatedProducts(
    @RequestParam(defaultValue = "0") int page,
    @RequestParam(defaultValue = "5") int size) {
    return productRepository.findAll(PageRequest.of(page, size));
}

```

üí° **API Call:** `http://localhost:8080/products/paginated?page=1&size=5`

---

## **üìå Sorting & Pagination Together**

We can **combine sorting and pagination** for optimal data retrieval.

### **‚û°Ô∏è** `**ProductRepository**` **for Pagination with Sorting**

```Java
java
CopyEdit
@Repository
public interface ProductRepository extends JpaRepository<ProductEntity, Long> {

    // Pagination with Sorting
    Page<ProductEntity> findAll(Pageable pageable);
}

```

### **‚û°Ô∏è API for Sorting & Pagination**

```Java
java
CopyEdit
@GetMapping("/paginated-sorted")
public Page<ProductEntity> getPaginatedSortedProducts(
    @RequestParam(defaultValue = "0") int page,
    @RequestParam(defaultValue = "5") int size,
    @RequestParam(defaultValue = "id") String sortBy) {

    Pageable pageable = PageRequest.of(page, size, Sort.by(sortBy));
    return productRepository.findAll(pageable);
}

```

üí° **API Call:** `http://localhost:8080/products/paginated-sorted?page=0&size=5&sortBy=price`

---

## **üìå Filtering + Sorting + Pagination Together**

```Java
java
CopyEdit
@GetMapping("/filtered-paginated-sorted")
public Page<ProductEntity> getFilteredPaginatedSortedProducts(
    @RequestParam(defaultValue = "0") int page,
    @RequestParam(defaultValue = "5") int size,
    @RequestParam(defaultValue = "id") String sortBy,
    @RequestParam(defaultValue = "") String title) {

    Pageable pageable = PageRequest.of(page, size, Sort.by(sortBy));
    return productRepository.findByTitleContainingIgnoreCase(title, pageable);
}

```

üí° **API Call:** `http://localhost:8080/products/filtered-paginated-sorted?page=1&size=5&sortBy=price&title=coca`

---

## **üìå Summary Table**

|   |   |   |
|---|---|---|
|**Feature**|**Method**|**Usage**|
|**Basic Sorting**|`findByTitleOrderByPrice`|Sort using method names|
|**Dynamic Sorting**|`Sort.by(sortBy)`|Pass sorting field dynamically|
|**Multiple Sorting Fields**|`Sort.by(Sort.Order.desc("quantity"), Sort.Order.asc("price"))`|Sort using multiple fields|
|**Pagination**|`PageRequest.of(page, size)`|Fetch paginated results|
|**Sorting + Pagination**|`PageRequest.of(page, size, Sort.by(sortBy))`|Combine sorting and pagination|
|**Filtering + Sorting + Pagination**|`findByTitleContainingIgnoreCase(title, pageable)`|Combine all three features|

---

## **üìå Key Takeaways**

‚úÖ **Sorting:**

- Can be done using **method names** (`OrderBy`).
- More flexible using `**Sort.by()**`.
- Supports **multiple field sorting**.

‚úÖ **Pagination:**

- Uses `Pageable` and `PageRequest`.
- Prevents **overloading the database**.
- Uses `findAll(Pageable pageable)`.

‚úÖ **Sorting & Pagination Together:**

- Combine `PageRequest.of(page, size, Sort.by(sortBy))` for best performance.

---

## **üöÄ Final Thoughts**

Sorting and Pagination are essential in **real-world applications** to **enhance performance** and **user experience**. Mastering `Sort`, `Pageable`, and `PageRequest` will help in building **efficient** and **scalable** applications.