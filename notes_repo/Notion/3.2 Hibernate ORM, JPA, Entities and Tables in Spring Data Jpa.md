---

## **🔹 Introduction**

In this session, we will explore **Hibernate** and **JPA (Java Persistence API)** in detail, covering:

- **What is Hibernate?**
- **What is JPA?**
- **How JPA works with Hibernate?**
- **Spring Data JPA and its benefits**
- **How to configure Hibernate in a Spring Boot project**
- **Entity creation and mapping using annotations**
- **Understanding constraints, indexes, and table relationships**
- **How Hibernate auto-generates tables and initializes data**

---

# **🔹 What is Hibernate?**

Hibernate is a powerful **Object-Relational Mapping (ORM) framework** that **maps Java objects to database tables**. It eliminates the need for manually writing SQL queries and allows developers to interact with the database using Java objects.

### **✔ Why Hibernate?**

✅ Eliminates **boilerplate SQL code**

✅ **Automatic table creation** from Java classes

✅ **Optimized and scalable queries**

✅ Works with **multiple databases** (MySQL, MongoDB, etc.)

---

# **🔹 Understanding JPA (Java Persistence API)**

JPA is **a specification** that defines how ORM frameworks (such as Hibernate) should work. Hibernate is **an implementation** of JPA.

### **✔ JPA vs. Hibernate**

|   |   |   |
|---|---|---|
|Feature|JPA|Hibernate|
|**Type**|Specification (Interface)|Implementation|
|**Role**|Defines ORM rules|Implements ORM features|
|**Flexibility**|Can switch between providers (e.g., Hibernate, EclipseLink)|A complete ORM solution|

### **✔ Why Use JPA?**

✅ **Standardized ORM approach**

✅ **Supports multiple ORM implementations**

✅ Provides **annotations for mapping objects to database**

> 📝 Example:

- **JPA** defines `@Entity`, `@Column`, and `@Id` annotations.
- **Hibernate** implements these and provides additional optimizations.

---

# **🔹 Spring Data JPA: Simplifying Database Operations**

Spring Data JPA is **built on top of JPA** and helps in reducing **boilerplate code** when working with databases.

### **✔ Advantages of Spring Data JPA**

✅ **Automatic query generation** – No need to write SQL queries.

✅ **Supports CRUD operations** – Create, Read, Update, Delete without writing queries.

✅ **Simplifies DAO (Data Access Object) management**

> 📝 Example: Using Spring Data JPA Repository

```Java
java
CopyEdit
public interface ProductRepository extends CrudRepository<Product, Long> {
}

```

- No need to write queries for **finding, saving, or deleting entities**.
- Spring Data JPA **automatically generates the required SQL queries**.

---

# **🔹 Hibernate Workflow**

1. **Java Application** interacts with **Hibernate**.
2. **Hibernate** converts Java objects into **database tables**.
3. **SQL Queries** are automatically generated by **Hibernate**.
4. **JPA Layer** provides an **abstract API** to work with Hibernate.

### **✔ Hibernate vs. JDBC**

|   |   |   |
|---|---|---|
|Feature|JDBC|Hibernate|
|**SQL Writing**|Required|Not required|
|**ORM Support**|No|Yes|
|**Automatic Table Mapping**|No|Yes|
|**Cross-Database Compatibility**|No|Yes|

---

# **🔹 Setting Up Hibernate in a Spring Boot Project**

We use **Spring Initializer** to create a new Spring Boot project.

### **✔ Project Configuration**

- **Build Tool**: Maven
- **Spring Boot Version**: 3.3.0
- **Group**: `coding.shuttle.jpa.tutorial`
- **Artifact**: `jpaTuts`
- **Project Name**: `jpaTutorial`
- **Packaging**: `JAR`
- **Java Version**: 17+

### **✔ Dependencies**

📌 Add the following dependencies:

1. **Spring Web**
2. **Spring Data JPA**
3. **MySQL Driver**
4. **Lombok**

---

# **🔹 Hibernate Annotations & Configuration**

## **✔ Entity Definition**

```Java
java
CopyEdit
@Entity
@Table(
    name = "product_table",
    uniqueConstraints = {
        @UniqueConstraint(name = "sku_unique", columnNames = {"sku"}),
        @UniqueConstraint(name = "title_price_unique", columnNames = {"title_x", "price"})
    }
)
@Data
@AllArgsConstructor
@NoArgsConstructor
@Builder
public class Product {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false, unique = true, length = 20)
    private String sku;

    @Column(name = "title_x")
    private String title;

    private BigDecimal price;
    private int quantity;

    @CreationTimestamp
    private LocalDateTime createdAt;

    @UpdateTimestamp
    private LocalDateTime updatedAt;
}

```

---

# **🔹 Configuring** `**application.properties**`

```Plain
properties
CopyEdit
spring.datasource.url=jdbc:mysql://localhost:3306/test?useSSL=false
spring.datasource.username=root
spring.datasource.password=yourpassword

# Hibernate Configurations
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

```

---

# **🔹 Hibernate Table Creation (DDL)**

✅ When we run the application, Hibernate **automatically creates the table** in MySQL:

```SQL
sql
CopyEdit
CREATE TABLE product_table (
    id BIGINT NOT NULL AUTO_INCREMENT,
    sku VARCHAR(20) NOT NULL UNIQUE,
    title_x VARCHAR(255),
    price DECIMAL,
    quantity INT,
    created_at DATETIME,
    updated_at DATETIME,
    PRIMARY KEY (id)
);

```

✅ Unique constraints & indexes are created:

```SQL
sql
CopyEdit
ALTER TABLE product_table ADD CONSTRAINT sku_unique UNIQUE (sku);
ALTER TABLE product_table ADD CONSTRAINT title_price_unique UNIQUE (title_x, price);

```

---

# **🔹 Data Initialization in Hibernate**

📌 **Use** `**data.sql**` **for inserting default data**

```SQL
sql
CopyEdit
INSERT INTO product_table (sku, title_x, price, quantity) VALUES
('P123', 'Pepsi', 10.50, 100),
('C123', 'Coca-Cola', 12.00, 50);

```

📌 **Configure Data Initialization**

```Plain
properties
CopyEdit
spring.sql.init.mode=always
spring.sql.init.data-locations=classpath:data.sql

```

---

# **🔹 Key Features of JPA**

1. **Entity Management** – Standardized structure for defining entities.
2. **Query Language** – Supports JPQL (Java Persistence Query Language).
3. **Transaction Support** – Built-in database transaction management.
4. **Entity Relationships** – One-to-One, One-to-Many, Many-to-Many mappings.

---

# **📌 Summary**

|   |   |
|---|---|
|Concept|Explanation|
|**Hibernate**|ORM framework for Java|
|**JPA**|Specification for ORM|
|**Spring Data JPA**|Simplifies database operations|
|**Annotations**|Used for entity mapping|
|**DDL Auto**|Controls table creation behavior|
|**JPQL**|SQL-like language for querying entities|

---

### **🔹 Next Steps**

✔ Learn about **Spring Data JPA Repository**

✔ Implement **One-to-Many and Many-to-Many Relationships**

✔ Explore **Transactions in Hibernate**

---